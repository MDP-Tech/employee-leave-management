
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Log In | Shiftwave </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="A fully responsive admin theme which can be used to build CRM, CMS,ERP etc." name="description" />
    <meta content="Techzaa" name="author" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="/assets/images/favicon.ico">
    <!-- App css -->
    <link href="/assets/css/app.min.css?.v.2" rel="stylesheet" type="text/css" id="app-style" />
    <!-- Icons css -->
    <link href="/assets/css/icons.min.css" rel="stylesheet" type="text/css" />

    <style>
        @media only screen and (max-width: 768px) {
            #mobile_logo {
                display: block !important;
            }
      }
 </style>

</head>

<body class="authentication-bg position-relative">
    <div class="account-pages pt-2 pt-sm-5 pb-4 pb-sm-5 position-relative">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xxl-8 col-lg-7">
                    <div class="card overflow-hidden">
                        <div class="row g-0">
                            <div class="col-lg-6 d-none d-lg-block p-1">
                                <img src="/assets/images/login-image.jpg" alt="" class="img-fluid rounded h-100" style="background-size:cover ;">
                            </div>
                            <div class="col-lg-6">
                                <div class="d-flex flex-column h-100">
                                    
                                    <div class="p-4 my-auto">
                                        <!-- invalid credentials message -->
                                        <div class="container" id="mobile_logo" style="text-align: center; margin-bottom:20px; display: none;">
                                            <img src="https://hr.shiftwave.com/assets/images/logo.png" alt="Example Image" class="centered-image">
                                        </div>
                                        <!-- form -->
                                        <form  id="login-form" >
                                            <h5 class="fs-18 text-dark" >Log In</h5>
                                        <h6 class="text-muted mb-3" >Login with employee credentials.
                                        </h6>
                                        <div class="text-danger" id="invalid"></div>
                                           
                                            <div class="mb-2">
                                                <label for="emailaddress" class="form-label text-dark">Email ID</label>
                                                <input class="form-control" type="email" id="emailaddress" required=""
                                                    placeholder="Enter your email" maxlength="30">
                                                    <div class="text-danger"></div>
                                            </div>
                                      

                                            <div class="mb-1">
                                                
                                                <label for="password" class="form-label text-dark">Password</label>
                                                <div class="input-group input-group-merge">
                                                    <input type="password" id="password" class="form-control" placeholder="Enter your password" maxlength="15">
                                                    <div class="input-group-text" data-password="false">
                                                        <span class="password-eye"></span> <!-- Use any suitable eye icon here -->
                                                    </div>
                                                </div>

                                                
                                                <div class="text-danger" id="passwordError"></div> <!-- Error message for password field -->
                                            </div>
                                            <div>
                                            <a  href="" id="forgotpassword" class="float-end"><small><b style="color:#3BC0C3;font-size: 13px;">Forgot
                                                your
                                                password?</b></small></a>
                                            </div>

                                         
                                            
                                            <button style="width:100%;margin-bottom:20px;margin-top: 27px;" class="btn btn-primary waves-effect waves-light" type="submit" id="button"><span id="login-text">Log In</span></button>

                                        </form>
                                        
                                           <!-- reset password form -->
                                           <form id="resetPasswordFields" style="display: none;margin-top: -3px;">
                                            <a><h5 class="fs-18 text-dark" ><i class="ri-arrow-left-line" id="login_page"style="color:black;font-size:15px;margin-right:10px;cursor:pointer;"></i>Forgot Password</h5></a>
                                        <h6 class="text-muted mb-3" >Please Enter Your Email Address To Recieve a Verification Card
                                        </h6>
                                            <div class="text-bg-info" id="reset_sucessmessage"></div>
                                        <div class="text-danger" id="reset_failedmessage" style="display: none;"></div>
                                     
                                        
                                        <div class="mb-1 mt-0">
                                            <label for="reset_email" class="form-label text-dark">Email ID</label>
                                            <input type="email" id="reset_email" class="form-control" placeholder="Enter your email" maxlength="50">
                                            <div class="text-danger" id="email_alert"></div>
                                        </div>
                                        
                                           
                                            
                                            <div style="margin-top: 14px;margin-bottom: -13px;">
                                            
                                             <button style="width:100%;margin-top: 10px;margin-bottom: 100px;" class="btn btn-primary waves-effect waves-light" type="submit" id="mail" >Submit</button>
                                        </div>
                                        </form>
                                        <!-- end form-->
                                    </div>
                                </div>
                            </div> <!-- end col -->
                        </div>
                    </div>
                </div>
                <!-- end row -->
            </div>
            
            <!-- end row -->
        </div>
        <!-- end container -->
    </div>
    <!-- end page -->

    
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
   $(document).ready(function () {

    $("#mail").on('click',function (event) {

event.preventDefault();
$("#email_alert").text("");
$('#reset_failedmessage').text('');
var  email = $("#reset_email").val();

var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
var isValid = true;

if (email.trim() === '') {
    
    $("#email_alert").text("Please enter your email");
    var isValid = false;
    
}


 if (isValid)  {
    if (!emailRegex.test(email)) {
    $("#email_alert").text("Invalid email format");
    var isValid = false;
}

if (isValid) {

    $.ajax({
    
    type: 'POST',
    dataType: "json",
    data: { email:email },
    url: '/send-template',
    success: function (response) {
        if (response.status == 'Success') {
           
            window.location.href = "/account-security/reset-password";
          // $('#reset_sucessmessage').text('Sent mail template sucessfully')
            $('#reset_sucessmessage').show().fadeOut(7000);
            $("#newpassword").val('');
            $("#confirmpassword").val('');
            $("#reset_failedmessage").text('');
            $("#reset_email").val('');
            
               
           
        } else {
            
           
            $('#reset_failedmessage').text(response.status).show();
            
        }
    },
    error: function (xhr, status, error) {
        console.log("AJAX Error:", error);
    }
});
}  
    
}

            





})

// forgotpassword on click
    $("#forgotpassword").on('click',function (event) {
        event.preventDefault();
        
        $("#invalid").text("");
        $("#login-form").hide();
        $("#resetPasswordFields").show();
        
    })

   
// Save Password
$("#Save").on('click',function (event) {
    event.preventDefault();

    $("#password_alert").text("");
    $("#confirmpassword_alert").text("");
    $("#email_alert").text("");

    


   var isValid = true;
   
   var password = $("#newpassword").val();
    var confirm_password = $("#confirmpassword").val();
    var email = $("#reset_email").val();
    


    var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

if (email.trim() === '') {
    
    $("#email_alert").text("Please enter your email");
    var isValid = false;
    
}
if (isValid) {
    

if (!emailRegex.test(email)) {
    $("#email_alert").text("Invalid email format");
    var isValid = false;
} 
}

    if (password == '') {
        $("#password_alert").text("Please Enter Your New Password").show();
        isValid = false;

    }
    if(confirm_password == ''){
        $("#confirmpassword_alert").text("Please Enter Confirm Password ").show();
        isValid = false;

    }
    if (isValid) {
        
    
    if (password !== confirm_password) {
            $("#reset_failedmessage").text("Passwords do not match").show();
            isValid = false;
 
            
        }
    }

   

       
            
        if(isValid){

               
                         $.ajax({
                             type: 'POST',
                             dataType: "json",
                             data: { password:password,re_password:confirm_password,email:email },
                             url: '/employees/updatepassword',
                             success: function (response) {
                                 if (response.status == 'Sucessfully Updated') {
                                    
                                    $('#reset_sucessmessage').text(response.status)
                                    $('#reset_sucessmessage').show().fadeOut(7000);
                                     $("#newpassword").val('');
                                     $("#confirmpassword").val('');
                                     $("#reset_failedmessage").text('');
                                     $("#reset_email").val('');
                                     
                                        
                                    
                                 } else {
                                    
                                    $('#reset_failedmessage').text(response.status).fadeOut(7000).show();
                                     
                                 }
                             },
                             error: function (xhr, status, error) {
                                 console.log("AJAX Error:", error);
                             }
                         });

                        }

})


// back to login page
$("#login_page").on('click',function (event) {
    event.preventDefault();
    $("#emailaddress").val('');
    $("#reset_email").val('');
    $("#login-form").show();
    $("#email_alert").text("");
    $('#reset_failedmessage').text('');
    $("#passwordError").text("");
    $("#email_alert").text("");
    $("#emailaddress").siblings(".text-danger").text("");

        $("#resetPasswordFields").hide();
})

    // eye icon to visible password
$(".password-eye").on("click", function () {
        var password = $("#password");
        var passwordFieldType = password.attr("type");

        if (passwordFieldType === "password") {
            password.attr("type", "text");
        } else {
            password.attr("type", "password");
        }
    });

    $("#button").on('click', function (event) {
         event.preventDefault();
      
        var email = $("#emailaddress").val();
        var password = $("#password").val();
        var isValid = true;

        $(".text-danger").text(""); // Clear previous error messages

        var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        if (email.trim() === '') {
            $("#emailaddress").siblings(".text-danger").text("Please enter your email");
            var isValid = false;
            
        }
        if (isValid) {
            
        
        if (!emailRegex.test(email)) {
            $("#emailaddress").siblings(".text-danger").text("Invalid email format");
            var isValid = false;
        } 
    }
         if (password.trim() === '') {
            $("#passwordError").text("Please enter your password");
            var isValid = false;
        }
         if(isValid) {
            $('#button').html(`<div class="spinner-border spinner-border-sm" role="status">
  <span class="visually-hidden">Loading...</span>
</div>`)  
                    $.ajax({
                        type: 'POST',
                        dataType: "json",
                        data: { user_name: email, user_password: password },
                        url: '/employees/login',
                        success: function (response) {
                            alert('response')
                            if (response.status == 'Invalid credentials') {
                               
                                 $('#button').html(`Log In`)  
                                $("#invalid").text("Invalid Credentials").show();
                            } else {
                             
                                if (response.role == 'employee' ) {

                                    window.location.href = '/employees/dashboard'
                                    
                                }else {
                               
                                window.location.href = "/admin/dashboard";
                                }
                            }
                            $("#forgotpassword").html("<small>Forgot your password?</small>");
                        },
                        error: function (xhr, status, error) {
                            console.log("AJAX Error:", error);
                        }
                    });
                }

                
               
                $("#forgotpassword").html("<small>Forgot your password?</small>");
            
            });
        });
        </script>  
    


    

    <script src="assets/js/vendor.min.js"></script>

 
    <script src="assets/js/app.min.js"></script>
  

</body>

</html>


